<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IC PROJECT II: b.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IC PROJECT II
   </div>
   <div id="projectbrief">Entropy coding of audio and images</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">b.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file refers to the project's second challenge. It demonstrates the developed audio codecs that relie on predictive coding. To run the program successfuly you must include the option chosen (lossy or lossless), one audio file that must be .wav and a file name for the decompressed audio. lossless option -&gt; ./b lossless sample06.wav example.wav lossy option -&gt; ./b lossy sample06.wav example.wav.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;sndfile.h&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="_bit_stream_8hh_source.html">BitStream.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_golomb_8hh_source.html">Golomb.hh</a>&quot;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;chrono&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5967fc6cae3d1619155655c81ff9fe5a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="b_8cpp.html#a5967fc6cae3d1619155655c81ff9fe5a">predictor</a> (char *audio_file, char *choose, char *out_file)</td></tr>
<tr class="separator:a5967fc6cae3d1619155655c81ff9fe5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a395599c3982d76afdd7626807fb20f81"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="b_8cpp.html#a395599c3982d76afdd7626807fb20f81">folding</a> (short residual)</td></tr>
<tr class="separator:a395599c3982d76afdd7626807fb20f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a32b2a80af3a64acb8a173220d77af9"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="b_8cpp.html#a0a32b2a80af3a64acb8a173220d77af9">defolding</a> (short n)</td></tr>
<tr class="separator:a0a32b2a80af3a64acb8a173220d77af9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd2fad1b590d82a3534a9ef8fd0ca57"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="b_8cpp.html#adcd2fad1b590d82a3534a9ef8fd0ca57">calculate_m</a> (int sum)</td></tr>
<tr class="separator:adcd2fad1b590d82a3534a9ef8fd0ca57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8c531393121ad3a3c773816c8848f06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="b_8cpp.html#ad8c531393121ad3a3c773816c8848f06">lossless_encode</a> (short *error_buffer, int m)</td></tr>
<tr class="separator:ad8c531393121ad3a3c773816c8848f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97415554e20f9ec0a1c10afdcd88645"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="b_8cpp.html#af97415554e20f9ec0a1c10afdcd88645">lossless_decode</a> (int m, char *audio_file)</td></tr>
<tr class="separator:af97415554e20f9ec0a1c10afdcd88645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a138d188882e53441f2a0963a3262bf2d"><td class="memItemLeft" align="right" valign="top"><a id="a138d188882e53441f2a0963a3262bf2d" name="a138d188882e53441f2a0963a3262bf2d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>lossy_encode</b> (int m)</td></tr>
<tr class="separator:a138d188882e53441f2a0963a3262bf2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a559b2a1c4efefcd3947d1287c48820a0"><td class="memItemLeft" align="right" valign="top"><a id="a559b2a1c4efefcd3947d1287c48820a0" name="a559b2a1c4efefcd3947d1287c48820a0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>lossy_decode</b> (char *out_file)</td></tr>
<tr class="separator:a559b2a1c4efefcd3947d1287c48820a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a143d838dc20b2dcb9a6577e8bd6a22b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="b_8cpp.html#a143d838dc20b2dcb9a6577e8bd6a22b2">histograms</a> (short *buffer, short *error_buffer)</td></tr>
<tr class="separator:a143d838dc20b2dcb9a6577e8bd6a22b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top"><a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4a90587621a4ffa30b90630dd6179b1e"><td class="memItemLeft" align="right" valign="top">vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="b_8cpp.html#a4a90587621a4ffa30b90630dd6179b1e">code_info</a></td></tr>
<tr class="separator:a4a90587621a4ffa30b90630dd6179b1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ba8a7dbc1986adffb16f481d5b55fa3"><td class="memItemLeft" align="right" valign="top">short *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="b_8cpp.html#a2ba8a7dbc1986adffb16f481d5b55fa3">mono_buffer</a></td></tr>
<tr class="separator:a2ba8a7dbc1986adffb16f481d5b55fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0bbed14cf6294c187499179ee38189d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="b_8cpp.html#af0bbed14cf6294c187499179ee38189d">num_items</a></td></tr>
<tr class="separator:af0bbed14cf6294c187499179ee38189d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6993a4314b1f21cc6aa5614009106c94"><td class="memItemLeft" align="right" valign="top">SF_INFO&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="b_8cpp.html#a6993a4314b1f21cc6aa5614009106c94">sfinfo</a></td></tr>
<tr class="separator:a6993a4314b1f21cc6aa5614009106c94"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >This file refers to the project's second challenge. It demonstrates the developed audio codecs that relie on predictive coding. To run the program successfuly you must include the option chosen (lossy or lossless), one audio file that must be .wav and a file name for the decompressed audio. lossless option -&gt; ./b lossless sample06.wav example.wav lossy option -&gt; ./b lossy sample06.wav example.wav. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="adcd2fad1b590d82a3534a9ef8fd0ca57" name="adcd2fad1b590d82a3534a9ef8fd0ca57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd2fad1b590d82a3534a9ef8fd0ca57">&#9670;&nbsp;</a></span>calculate_m()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calculate_m </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >This function will calculate the 'optimal' m with the formula -&gt; ceil(-1/log2(mean/(mean+1)))</p>

</div>
</div>
<a id="a0a32b2a80af3a64acb8a173220d77af9" name="a0a32b2a80af3a64acb8a173220d77af9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a32b2a80af3a64acb8a173220d77af9">&#9670;&nbsp;</a></span>defolding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short defolding </td>
          <td>(</td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Defolding() will do the inverse of the <a class="el" href="b_8cpp.html#a395599c3982d76afdd7626807fb20f81">folding()</a> function.</p>

</div>
</div>
<a id="a395599c3982d76afdd7626807fb20f81" name="a395599c3982d76afdd7626807fb20f81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a395599c3982d76afdd7626807fb20f81">&#9670;&nbsp;</a></span>folding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short folding </td>
          <td>(</td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>residual</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Transforms an abritrary number into a positive number. If the given residual is negative it will turn into a positive odd number, else it will fold the number into his respective double number</p>

</div>
</div>
<a id="a143d838dc20b2dcb9a6577e8bd6a22b2" name="a143d838dc20b2dcb9a6577e8bd6a22b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a143d838dc20b2dcb9a6577e8bd6a22b2">&#9670;&nbsp;</a></span>histograms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int histograms </td>
          <td>(</td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>error_buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >calculating histograms and respective entropies, being the error_buffer &lt; buffer</p>

</div>
</div>
<a id="af97415554e20f9ec0a1c10afdcd88645" name="af97415554e20f9ec0a1c10afdcd88645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af97415554e20f9ec0a1c10afdcd88645">&#9670;&nbsp;</a></span>lossless_decode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lossless_decode </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>audio_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p ><a class="el" href="b_8cpp.html#af97415554e20f9ec0a1c10afdcd88645">lossless_decode()</a> will read an encoded file and decodes each code with the help of the code_info vector composed by the length of each code by order. It reads each code with length x using the <a class="el" href="class_bit_stream.html">BitStream</a> readBits() method, and "defolds" the integer to get the 'real' value. Afterwards it reverses the residual encoding formula to decode the residual. Finally, it will write the decoded data into an audio file with name given as arguments.</p>

</div>
</div>
<a id="ad8c531393121ad3a3c773816c8848f06" name="ad8c531393121ad3a3c773816c8848f06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8c531393121ad3a3c773816c8848f06">&#9670;&nbsp;</a></span>lossless_encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lossless_encode </td>
          <td>(</td>
          <td class="paramtype">short *&#160;</td>
          <td class="paramname"><em>error_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p ><a class="el" href="b_8cpp.html#ad8c531393121ad3a3c773816c8848f06">lossless_encode()</a> will encode each value in the error (or residual) buffer. It calculates its golomb code and writes it into a binary file via <a class="el" href="class_bit_stream.html">BitStream</a> class. This function uses a truncation mechanism that allows the bits to be written only if they are multiples of 8 (bytes) or have a code length bigger than 8 (byte). If there are remainder bits we will just add 0's to the end of the file.</p>

</div>
</div>
<a id="a5967fc6cae3d1619155655c81ff9fe5a" name="a5967fc6cae3d1619155655c81ff9fe5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5967fc6cae3d1619155655c81ff9fe5a">&#9670;&nbsp;</a></span>predictor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int predictor </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>audio_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>choose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>out_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >reads audio file, creates single channel buffer (avg of stereo), calculates the residual values (uses folding to get only positive values) based on predictive coding and calculates optimal m; it then encodes the value with its respective <a class="el" href="class_golomb.html">Golomb</a> code and writes to file using <a class="el" href="class_bit_stream.html">BitStream</a> class. It also compares the original buffer with the residual buffer (with calculated entropies); The residual buffer will always have less entropy.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4a90587621a4ffa30b90630dd6179b1e" name="a4a90587621a4ffa30b90630dd6179b1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a90587621a4ffa30b90630dd6179b1e">&#9670;&nbsp;</a></span>code_info</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;int&gt; code_info</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >vector with the length of each written code; used for decoding purposes </p>

</div>
</div>
<a id="a2ba8a7dbc1986adffb16f481d5b55fa3" name="a2ba8a7dbc1986adffb16f481d5b55fa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ba8a7dbc1986adffb16f481d5b55fa3">&#9670;&nbsp;</a></span>mono_buffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short* mono_buffer</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >mono channel buffer for generic purposes </p>

</div>
</div>
<a id="af0bbed14cf6294c187499179ee38189d" name="af0bbed14cf6294c187499179ee38189d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0bbed14cf6294c187499179ee38189d">&#9670;&nbsp;</a></span>num_items</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int num_items</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >static number of items of the mono channel ( half of the wav fil samples ) </p>

</div>
</div>
<a id="a6993a4314b1f21cc6aa5614009106c94" name="a6993a4314b1f21cc6aa5614009106c94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6993a4314b1f21cc6aa5614009106c94">&#9670;&nbsp;</a></span>sfinfo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SF_INFO sfinfo</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >audio file data structure </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
